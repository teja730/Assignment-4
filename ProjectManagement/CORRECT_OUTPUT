Creating user
Creating user
Creating user
Creating project
Creating project
Creating project
Creating job
Creating job
Creating job
Creating job
Running code
	Remaining jobs: 4
	Executing: DeepLearning from: IITD.CS.ML.ICML
	Project: IITD.CS.ML.ICML budget remaining: 5
Execution cycle completed
Querying
Kmeans: NOT FINISHED
Querying
Doesnotexists: NO SUCH JOB
Running code
	Remaining jobs: 3
	Executing: ImageProcessing from: IITD.CS.ML.ICML
	Un-sufficient budget.
	Executing: Pipeline from: IITD.CS.OS.ASPLOS
	Project: IITD.CS.OS.ASPLOS budget remaining: 90
Execution cycle completed
Creating job
No such project exists. IITD.CS.ML.ICM
Creating job
No such user exists: Rob2
Running code
	Remaining jobs: 1
	Executing: Kmeans from: IITD.CS.TH.SODA
	Project: IITD.CS.TH.SODA budget remaining: 90
Execution cycle completed
Creating job
Creating job
Creating job
Creating job
Running code
	Remaining jobs: 4
	Executing: DeepLearning1 from: IITD.CS.ML.ICML
	Un-sufficient budget.
	Executing: ImageProcessing1 from: IITD.CS.ML.ICML
	Un-sufficient budget.
	Executing: Pipeline1 from: IITD.CS.OS.ASPLOS
	Project: IITD.CS.OS.ASPLOS budget remaining: 80
Execution cycle completed
Creating job
Creating job
Creating job
Creating job
Running code
	Remaining jobs: 5
	Executing: DeepLearning2 from: IITD.CS.ML.ICML
	Un-sufficient budget.
	Executing: ImageProcessing2 from: IITD.CS.ML.ICML
	Un-sufficient budget.
	Executing: Pipeline2 from: IITD.CS.OS.ASPLOS
	Project: IITD.CS.OS.ASPLOS budget remaining: 70
Execution cycle completed
ADDING Budget
Creating job
Creating job
Creating job
Creating job
Running code
	Remaining jobs: 11
	Executing: ImageProcessing from: IITD.CS.ML.ICML
	Project: IITD.CS.ML.ICML budget remaining: 55
Execution cycle completed
Querying
Kmeans: COMPLETED
Running code
	Remaining jobs: 10
	Executing: DeepLearning1 from: IITD.CS.ML.ICML
	Project: IITD.CS.ML.ICML budget remaining: 45
Execution cycle completed
Creating job
Creating job
Creating job
Creating job
Running code
	Remaining jobs: 13
	Executing: ImageProcessing1 from: IITD.CS.ML.ICML
	Project: IITD.CS.ML.ICML budget remaining: 35
Execution cycle completed
Creating job
Creating job
Creating job
Creating job
Running code
	Remaining jobs: 16
	Executing: DeepLearning2 from: IITD.CS.ML.ICML
	Project: IITD.CS.ML.ICML budget remaining: 25
Execution cycle completed
Querying
Kmeans: COMPLETED
Running code
	Remaining jobs: 15
	Executing: ImageProcessing2 from: IITD.CS.ML.ICML
	Project: IITD.CS.ML.ICML budget remaining: 15
Execution cycle completed
Project query
Time elapsed (ns): 1309127
User query
Time elapsed (ns): 334013
Project User query
Time elapsed (ns): 350450
Priority query
Time elapsed (ns): 217503
Top query
Time elapsed (ns): 887377
Flush query
Job{user='Carry', project='IITD.CS.TH.SODA', jobstatus=REQUESTED, execution_time=10, end_time=null, priority=2147483647, name='Kmeans1'}
Job{user='Carry', project='IITD.CS.TH.SODA', jobstatus=REQUESTED, execution_time=10, end_time=null, priority=2147483647, name='Kmeans2'}
Job{user='Rob', project='IITD.CS.ML.ICML', jobstatus=REQUESTED, execution_time=10, end_time=null, priority=2147483647, name='DeepLearning3'}
Job{user='Carry', project='IITD.CS.ML.ICML', jobstatus=REQUESTED, execution_time=10, end_time=null, priority=2147483647, name='ImageProcessing3'}
Job{user='Harry', project='IITD.CS.OS.ASPLOS', jobstatus=REQUESTED, execution_time=10, end_time=null, priority=2147483647, name='Pipeline3'}
Job{user='Carry', project='IITD.CS.TH.SODA', jobstatus=REQUESTED, execution_time=10, end_time=null, priority=2147483647, name='Kmeans3'}
Job{user='Rob', project='IITD.CS.ML.ICML', jobstatus=REQUESTED, execution_time=10, end_time=null, priority=10, name='DeepLearning4'}
Job{user='Carry', project='IITD.CS.ML.ICML', jobstatus=REQUESTED, execution_time=10, end_time=null, priority=10, name='ImageProcessing4'}
Job{user='Harry', project='IITD.CS.OS.ASPLOS', jobstatus=REQUESTED, execution_time=10, end_time=null, priority=9, name='Pipeline4'}
Job{user='Carry', project='IITD.CS.TH.SODA', jobstatus=REQUESTED, execution_time=10, end_time=null, priority=8, name='Kmeans4'}
Job{user='Rob', project='IITD.CS.ML.ICML', jobstatus=REQUESTED, execution_time=10, end_time=null, priority=10, name='DeepLearning5'}
Job{user='Carry', project='IITD.CS.ML.ICML', jobstatus=REQUESTED, execution_time=10, end_time=null, priority=10, name='ImageProcessing5'}
Job{user='Harry', project='IITD.CS.OS.ASPLOS', jobstatus=REQUESTED, execution_time=10, end_time=null, priority=9, name='Pipeline5'}
Job{user='Carry', project='IITD.CS.TH.SODA', jobstatus=REQUESTED, execution_time=10, end_time=null, priority=8, name='Kmeans5'}
Running code
	Remaining jobs: 14
	Executing: Kmeans1 from: IITD.CS.TH.SODA
	Project: IITD.CS.TH.SODA budget remaining: 80
Execution cycle completed
Running code
	Remaining jobs: 13
	Executing: Kmeans2 from: IITD.CS.TH.SODA
	Project: IITD.CS.TH.SODA budget remaining: 70
Execution cycle completed
Running code
	Remaining jobs: 12
	Executing: ImageProcessing3 from: IITD.CS.ML.ICML
	Project: IITD.CS.ML.ICML budget remaining: 5
System execution completed
Running code
	Remaining jobs: 11
	Executing: Pipeline3 from: IITD.CS.OS.ASPLOS
	Project: IITD.CS.OS.ASPLOS budget remaining: 60
System execution completed
Running code
	Remaining jobs: 10
	Executing: DeepLearning3 from: IITD.CS.ML.ICML
	Un-sufficient budget.
	Executing: Kmeans3 from: IITD.CS.TH.SODA
	Project: IITD.CS.TH.SODA budget remaining: 60
System execution completed
Running code
	Remaining jobs: 8
	Executing: DeepLearning4 from: IITD.CS.ML.ICML
	Un-sufficient budget.
	Executing: ImageProcessing4 from: IITD.CS.ML.ICML
	Un-sufficient budget.
	Executing: DeepLearning5 from: IITD.CS.ML.ICML
	Un-sufficient budget.
	Executing: ImageProcessing5 from: IITD.CS.ML.ICML
	Un-sufficient budget.
	Executing: Pipeline4 from: IITD.CS.OS.ASPLOS
	Project: IITD.CS.OS.ASPLOS budget remaining: 50
System execution completed
Running code
	Remaining jobs: 3
	Executing: Pipeline5 from: IITD.CS.OS.ASPLOS
	Project: IITD.CS.OS.ASPLOS budget remaining: 40
System execution completed
Running code
	Remaining jobs: 2
	Executing: Kmeans4 from: IITD.CS.TH.SODA
	Project: IITD.CS.TH.SODA budget remaining: 50
System execution completed
Running code
	Remaining jobs: 1
	Executing: Kmeans5 from: IITD.CS.TH.SODA
	Project: IITD.CS.TH.SODA budget remaining: 40
System execution completed
--------------STATS---------------
Total jobs done: 19
Job{user='Rob', project='IITD.CS.ML.ICML', jobstatus=COMPLETED, execution_time=10, end_time=10, priority=10, name='DeepLearning'}
Job{user='Harry', project='IITD.CS.OS.ASPLOS', jobstatus=COMPLETED, execution_time=10, end_time=20, priority=9, name='Pipeline'}
Job{user='Carry', project='IITD.CS.TH.SODA', jobstatus=COMPLETED, execution_time=10, end_time=30, priority=8, name='Kmeans'}
Job{user='Rob', project='IITD.CS.OS.ASPLOS', jobstatus=COMPLETED, execution_time=10, end_time=40, priority=9, name='Pipeline1'}
Job{user='Harry', project='IITD.CS.OS.ASPLOS', jobstatus=COMPLETED, execution_time=10, end_time=50, priority=9, name='Pipeline2'}
Job{user='Carry', project='IITD.CS.ML.ICML', jobstatus=COMPLETED, execution_time=10, end_time=60, priority=10, name='ImageProcessing'}
Job{user='Rob', project='IITD.CS.ML.ICML', jobstatus=COMPLETED, execution_time=10, end_time=70, priority=10, name='DeepLearning1'}
Job{user='Carry', project='IITD.CS.ML.ICML', jobstatus=COMPLETED, execution_time=10, end_time=80, priority=10, name='ImageProcessing1'}
Job{user='Rob', project='IITD.CS.ML.ICML', jobstatus=COMPLETED, execution_time=10, end_time=90, priority=10, name='DeepLearning2'}
Job{user='Carry', project='IITD.CS.ML.ICML', jobstatus=COMPLETED, execution_time=10, end_time=100, priority=10, name='ImageProcessing2'}
Job{user='Carry', project='IITD.CS.TH.SODA', jobstatus=COMPLETED, execution_time=10, end_time=110, priority=2147483647, name='Kmeans1'}
Job{user='Carry', project='IITD.CS.TH.SODA', jobstatus=COMPLETED, execution_time=10, end_time=120, priority=2147483647, name='Kmeans2'}
Job{user='Carry', project='IITD.CS.ML.ICML', jobstatus=COMPLETED, execution_time=10, end_time=130, priority=2147483647, name='ImageProcessing3'}
Job{user='Harry', project='IITD.CS.OS.ASPLOS', jobstatus=COMPLETED, execution_time=10, end_time=140, priority=2147483647, name='Pipeline3'}
Job{user='Carry', project='IITD.CS.TH.SODA', jobstatus=COMPLETED, execution_time=10, end_time=150, priority=2147483647, name='Kmeans3'}
Job{user='Harry', project='IITD.CS.OS.ASPLOS', jobstatus=COMPLETED, execution_time=10, end_time=160, priority=9, name='Pipeline4'}
Job{user='Harry', project='IITD.CS.OS.ASPLOS', jobstatus=COMPLETED, execution_time=10, end_time=170, priority=9, name='Pipeline5'}
Job{user='Carry', project='IITD.CS.TH.SODA', jobstatus=COMPLETED, execution_time=10, end_time=180, priority=8, name='Kmeans4'}
Job{user='Carry', project='IITD.CS.TH.SODA', jobstatus=COMPLETED, execution_time=10, end_time=190, priority=8, name='Kmeans5'}
------------------------
Unfinished jobs: 
Job{user='Rob', project='IITD.CS.ML.ICML', jobstatus=REQUESTED, execution_time=10, end_time=null, priority=2147483647, name='DeepLearning3'}
Job{user='Rob', project='IITD.CS.ML.ICML', jobstatus=REQUESTED, execution_time=10, end_time=null, priority=10, name='DeepLearning4'}
Job{user='Carry', project='IITD.CS.ML.ICML', jobstatus=REQUESTED, execution_time=10, end_time=null, priority=10, name='ImageProcessing4'}
Job{user='Rob', project='IITD.CS.ML.ICML', jobstatus=REQUESTED, execution_time=10, end_time=null, priority=10, name='DeepLearning5'}
Job{user='Carry', project='IITD.CS.ML.ICML', jobstatus=REQUESTED, execution_time=10, end_time=null, priority=10, name='ImageProcessing5'}
Total unfinished jobs: 5
--------------STATS DONE---------------
private ArrayList<JobReport_> handle_new_projectuser(String[] cmd) {
        ArrayList<JobReport_> list=new ArrayList<>();
        int t1=Integer.parseInt(cmd[3]);
        int t2=Integer.parseInt(cmd[4]);

        try {
            ArrayList<Job> jobs;
            jobs=((Project)projects.search(cmd[1]).getValue()).jobs;
            for (Job job:jobs){
                if (job.user().compareTo(cmd[2])==0&&job.arrivaltime>=t1&&job.arrivaltime<=t2)
                    list.add(job);
            }
            //System.out.println("size ;"+list.size());
            return list;
        }catch (NullPointerException e){
            return null;
        }

    }
    private ArrayList<JobReport_> handle_new_user(String[] cmd) {

            ArrayList<JobReport_> list=new ArrayList<>();
            int t1=Integer.parseInt(cmd[2]);
            int t2=Integer.parseInt(cmd[3]);

            for (int i=0;i<alljobsarray.size();i++){
                Job job =alljobsarray.get(i);
                if (job.user().compareTo(cmd[1])==0&&job.arrivaltime>=t1&&job.arrivaltime<=t2)
                    list.add(job);
            }
        //System.out.println("size ;"+list.size());

        return list;

    }
    private ArrayList<JobReport_> handle_new_project(String[] cmd) {
            ArrayList<JobReport_> list=new ArrayList<>();
            int t1=Integer.parseInt(cmd[2]);
            int t2=Integer.parseInt(cmd[3]);
        Project project=((Project)projects.search(cmd[1]).getValue());
        if (project==null)
            return null;
        ArrayList<Job> jobs=project.jobs;
            for (Job job:jobs){
                if (job.arrivaltime>=t1&&job.arrivaltime<=t2)
                    list.add(job);
            }
        //System.out.println("size ;"+list.size());

        return list;

    }
    public void schedule() {
            execute_a_job();
    }
    @Override
    public void run_to_completion() {
        while (true){
            System.out.println("Running code\n" + "Remaining jobs: " + jobscount);
            schedule();
            System.out.println("System execution completed");
            if (jobscount<=0)
                break;
        }
    }
    @Override
    public void handle_project(String[] cmd) {
        System.out.println("Creating project");
        Project project=new Project();
        projects_order++;
        project.k=projects_order;
        project.name=cmd[1];
        project.priority=Integer.parseInt(cmd[2]);
        project.budget=Integer.parseInt(cmd[3]);
        projects.insert(cmd[1],project);
    }
    @Override
    public void handle_job(String[] cmd) {
        System.out.println("Creating job");
        TrieNode<Project> projectNode=projects.search(cmd[2]);
        User user=null;
        for (int i=0;i<users.size();i++){
            if (users.get(i).name.equals(cmd[3])) {
                user=users.get(i);
                break;
            }
        }
        if (projectNode==null)
            System.out.println("No such project exists. "+cmd[2]);
        else if (user==null)
            System.out.println("No such user exists: "+cmd[3]);
        else {
            Job job = new Job();
            job.name=cmd[1];
            job.runtime=Integer.parseInt(cmd[4]);
            job.user=user;
            jobs_order++;
            job.k=jobs_order;
            //System.out.println(k);
            job.project=projectNode.getValue();
            jobs.insert(job);
            job.arrivaltime=globaltime;
            alljobs.insert(job.name,job);
            alljobsarray.add(job);
            projectNode.getValue().jobs.add(job);
            jobscount++;
        }
    }
